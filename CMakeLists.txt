CMAKE_MINIMUM_REQUIRED(VERSION 3.6)
PROJECT(uvsocks5 C)

SET(CMAKE_C_STANDARD 99)

# LIBUV DIR
SET(LIBUV_DIR ${CMAKE_SOURCE_DIR}/libuv)

SET(SOCKS5LIBUV_ADDTION_HDR
        ${LIBUV_DIR}/include
        )

INCLUDE_DIRECTORIES(${SOCKS5LIBUV_ADDTION_HDR})

# ADD LIBUV PROJECT
ADD_SUBDIRECTORY(${LIBUV_DIR})


SET(SOCKS5LIBUV_SRCS
        src/client.c
        src/s5.c
        src/server.c
        src/util.c
)

ADD_LIBRARY(uvsocks5 STATIC ${SOCKS5LIBUV_SRCS})
TARGET_LINK_LIBRARIES(uvsocks5 uv_a)

ADD_EXECUTABLE(uvsocks5-loader program/main.c program/getopt.c)
TARGET_LINK_LIBRARIES(uvsocks5-loader uvsocks5)
